<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edu 360 - Hệ thống quản lý giáo dục</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="logo">Edu 360</h1>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item active" data-module="feeitem">
                        <span class="nav-icon">💰</span>
                        <span class="nav-text">Khoản phí</span>
                    </li>
                    <li class="nav-item" data-module="payment-period">
                        <span class="nav-icon">📅</span>
                        <span class="nav-text">Đợt thanh toán</span>
                    </li>
                    <li class="nav-item" data-module="fee-config">
                        <span class="nav-icon">🧩</span>
                        <span class="nav-text">Cấu hình phí</span>
                    </li>
                    <li class="nav-item" data-module="student-fee-config">
                        <span class="nav-icon">👨‍🎓</span>
                        <span class="nav-text">Cấu hình khoản phí cho học sinh</span>
                    </li>
                    <li class="nav-item" data-module="debt-management">
                        <span class="nav-icon">💳</span>
                        <span class="nav-text">Quản lý khoản nợ</span>
                    </li>
                    <li class="nav-item" data-module="invoice-management">
                        <span class="nav-icon">🧾</span>
                        <span class="nav-text">Quản lý Hóa đơn</span>
                    </li>
                    <li class="nav-item" data-module="final-grade">
                        <span class="nav-icon">📝</span>
                        <span class="nav-text">Nhập điểm cuối kỳ</span>
                    </li>
                    <li class="nav-item" data-module="grade">
                        <span class="nav-icon">📊</span>
                        <span class="nav-text">Tạo đầu điểm</span>
                    </li>
                    <li class="nav-item" data-module="grade-input">
                        <span class="nav-icon">✏️</span>
                        <span class="nav-text">Nhập điểm</span>
                    </li>
                    <li class="nav-item" data-module="grade-approval">
                        <span class="nav-icon">✅</span>
                        <span class="nav-text">Duyệt điểm</span>
                    </li>
                    <li class="nav-item" data-module="schedule">
                        <span class="nav-icon">📅</span>
                        <span class="nav-text">Lịch học</span>
                    </li>
                    <li class="nav-item" data-module="attendance">
                        <span class="nav-icon">✓</span>
                        <span class="nav-text">Điểm danh</span>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-content">
                    <div class="header-left">
                        <h2 class="page-title">Project Management</h2>
                    </div>
                    <div class="header-right">
                        <span class="current-date" id="currentDate"></span>
                        <div class="language-selector">
                            <span class="flag-icon">🇻🇳</span>
                        </div>
                        <div class="user-profile">
                            <div class="user-avatar">AD</div>
                            <span class="user-name">Admin</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- FeeItem Module -->
                <div class="module-content active" id="feeitem-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Quản lý Khoản phí</h3>
                            <button class="btn btn-primary" onclick="showAddFeeItemForm()">
                                <span>+</span> Thêm mới FeeItem
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã code</th>
                                        <th>Tên khoản phí (EN)</th>
                                        <th>Tên khoản phí (MY)</th>
                                        <th>Mô tả</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="feeitem-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>FEE001</td>
                                        <td>Tuition Fee</td>
                                        <td>ကျောင်းလချေး</td>
                                        <td>Phí học phí hàng kỳ</td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem">👁️</button>
                                            <button class="btn-icon btn-edit" title="Sửa">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa">🗑️</button>
                                            <button class="btn-icon btn-active" title="Active">✓</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add FeeItem Form Modal -->
                    <div class="modal" id="add-feeitem-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm mới FeeItem</h3>
                                <button class="modal-close" onclick="closeModal('add-feeitem-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="feeitem-form">
                                    <div class="form-group">
                                        <label>Mã code <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Tên khoản phí tiếng Anh <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Tên khoản phí tiếng Myanmar <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Mô tả</label>
                                        <textarea class="form-control" rows="3" placeholder="Nhập mô tả cho khoản phí"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-feeitem-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Period Module -->
                <div class="module-content" id="payment-period-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Quản lý Đợt thanh toán</h3>
                            <button class="btn btn-primary" onclick="showAddPaymentPeriodForm()">
                                <span>+</span> Thêm mới đợt thanh toán
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã code</th>
                                        <th>Kỳ học</th>
                                        <th>Tên đợt thanh toán (EN)</th>
                                        <th>Tên đợt thanh toán (MY)</th>
                                        <th>Ngày bắt đầu</th>
                                        <th>Ngày kết thúc</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="payment-period-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>PP001</td>
                                        <td>Học kỳ 1</td>
                                        <td>First Semester Payment</td>
                                        <td>ပထမနှစ်ဝက် ငွေပေးချေမှု</td>
                                        <td>01/01/2024</td>
                                        <td>31/03/2024</td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem">👁️</button>
                                            <button class="btn-icon btn-edit" title="Sửa">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa">🗑️</button>
                                            <button class="btn-icon btn-active" title="Active">✓</button>
                                            <button class="btn-icon" style="background-color: rgba(13, 110, 253, 0.1);" title="Cấu hình" onclick="showPaymentConfigForPeriod('PP001', 'First Semester Payment')">⚙️</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add Payment Period Form Modal -->
                    <div class="modal" id="add-payment-period-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm mới Đợt thanh toán</h3>
                                <button class="modal-close" onclick="closeModal('add-payment-period-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="payment-period-form">
                                    <div class="form-group">
                                        <label>Mã code <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Kỳ học <span class="required">*</span></label>
                                        <select class="form-control" required>
                                            <option value="">-- Chọn kỳ học --</option>
                                            <option value="semester1">Học kỳ 1</option>
                                            <option value="semester2">Học kỳ 2</option>
                                            <option value="semester3">Học kỳ 3</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Tên đợt thanh toán tiếng Anh <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Tên đợt thanh toán tiếng Myanmar <span class="required">*</span></label>
                                        <input type="text" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Ngày bắt đầu <span class="required">*</span></label>
                                        <input type="date" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Ngày kết thúc <span class="required">*</span></label>
                                        <input type="date" class="form-control" required>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-payment-period-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Config Module -->
                <div class="module-content" id="payment-config-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Cấu hình Đợt thanh toán</h3>
                            <div style="display: flex; gap: 12px;">
                                <button class="btn btn-secondary" onclick="showPaymentPeriodModule()">
                                    <span>←</span> Quay lại
                                </button>
                                <button class="btn btn-primary" onclick="showAddPaymentConfigForm()">
                                    <span>+</span> Thêm cấu hình
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Tên đợt thanh toán</th>
                                        <th>Tên FeeItem</th>
                                        <th>Ghi chú</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="payment-config-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>First Semester Payment</td>
                                        <td>Tuition Fee</td>
                                        <td>Ghi chú cho cấu hình đợt thanh toán</td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem">👁️</button>
                                            <button class="btn-icon btn-edit" title="Sửa">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa">🗑️</button>
                                            <button class="btn-icon btn-active" title="Active">✓</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add Payment Config Form Modal -->
                    <div class="modal" id="add-payment-config-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm mới Cấu hình</h3>
                                <button class="modal-close" onclick="closeModal('add-payment-config-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="payment-config-form">
                                    <div class="form-group">
                                        <label>Đợt thanh toán</label>
                                        <div class="form-control" style="background-color: #f5f7fa; color: #505050;" id="payment-config-period-display">
                                            -- Chọn đợt thanh toán từ danh sách --
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>FeeItem <span class="required">*</span></label>
                                        <select class="form-control" required>
                                            <option value="">-- Chọn FeeItem --</option>
                                            <option value="1">Tuition Fee</option>
                                            <option value="2">Library Fee</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Ghi chú</label>
                                        <textarea class="form-control" rows="3" placeholder="Nhập ghi chú (nếu có)"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-payment-config-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fee Config Module -->
                <div class="module-content" id="fee-config-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Cấu hình phí</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select class="form-control" id="fee-config-status-filter" style="width: 180px;" onchange="filterFeeConfigList()">
                                    <option value="">-- Tất cả trạng thái --</option>
                                    <option value="Đang soạn">Đang soạn</option>
                                    <option value="Chờ xác nhận">Chờ xác nhận</option>
                                    <option value="Xác nhận">Xác nhận</option>
                                    <option value="Từ chối">Từ chối</option>
                                </select>
                                <button class="btn btn-primary" onclick="showAddFeeConfigForm()">
                                    <span>+</span> Tạo cấu hình mới
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table" id="fee-config-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Lớp</th>
                                        <th>Đợt thanh toán</th>
                                        <th>Kỳ học</th>
                                        <th>Trạng thái</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="fee-config-table-body">
                                    <tr>
                                        <td colspan="6" style="text-align: center; padding: 40px; color: #505050; font-size: 14px;">
                                            Chưa có cấu hình phí. Nhấn “Tạo cấu hình mới” để thêm.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add/Edit Fee Config Modal -->
                    <div class="modal" id="add-fee-config-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 id="fee-config-modal-title">Tạo cấu hình mới</h3>
                                <button class="modal-close" onclick="closeModal('add-fee-config-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="fee-config-form">
                                    <input type="hidden" id="fee-config-id" value="">
                                    <div class="form-group">
                                        <label>Chọn Kỳ học <span class="required">*</span></label>
                                        <select class="form-control" id="fee-config-semester" required onchange="onFeeConfigSemesterChange()">
                                            <option value="">-- Chọn kỳ học --</option>
                                            <option value="semester1">Học kỳ 1</option>
                                            <option value="semester2">Học kỳ 2</option>
                                            <option value="semester3">Học kỳ 3</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Chọn đợt thanh toán <span class="required">*</span></label>
                                        <select class="form-control" id="fee-config-period" required disabled>
                                            <option value="">-- Chọn đợt thanh toán --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Chọn lớp <span class="required">*</span></label>
                                        <select class="form-control" id="fee-config-class" required>
                                            <option value="">-- Chọn lớp --</option>
                                            <option value="10A1">10A1</option>
                                            <option value="10A2">10A2</option>
                                            <option value="11A1">11A1</option>
                                            <option value="11A2">11A2</option>
                                            <option value="12A1">12A1</option>
                                            <option value="12A2">12A2</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="fee-config-status-group" style="display:none;">
                                        <label>Trạng thái</label>
                                        <select class="form-control" id="fee-config-status">
                                            <option value="Đang soạn">Đang soạn</option>
                                            <option value="Chờ xác nhận">Chờ xác nhận</option>
                                            <option value="Xác nhận">Xác nhận</option>
                                            <option value="Từ chối">Từ chối</option>
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-fee-config-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Student Fee Config Module -->
                <div class="module-content" id="student-fee-config-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Cấu hình khoản phí cho học sinh</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select class="form-control" id="student-fee-semester-filter" style="width: 180px;" onchange="onStudentFeeSemesterChange()">
                                    <option value="">-- Chọn kỳ học --</option>
                                    <option value="semester1">Học kỳ 1</option>
                                    <option value="semester2">Học kỳ 2</option>
                                    <option value="semester3">Học kỳ 3</option>
                                </select>
                                <select class="form-control" id="student-fee-period-filter" style="width: 200px;" onchange="onStudentFeePeriodChange()">
                                    <option value="">-- Chọn đợt thanh toán --</option>
                                </select>
                                <select class="form-control" id="student-fee-class-filter" style="width: 180px;" onchange="onStudentFeeClassChange()">
                                    <option value="">-- Chọn lớp --</option>
                                    <option value="10A1">10A1</option>
                                    <option value="10A2">10A2</option>
                                    <option value="11A1">11A1</option>
                                    <option value="11A2">11A2</option>
                                    <option value="12A1">12A1</option>
                                    <option value="12A2">12A2</option>
                                </select>
                                <div id="student-fee-config-status-badge" style="margin-left: 8px;"></div>
                                <button class="btn btn-primary" id="student-fee-config-save-btn" onclick="saveStudentFeeConfig()">
                                    <span>💾</span> Lưu cấu hình
                                </button>
                                <button class="btn btn-primary" id="student-fee-config-approve-btn" style="display:none;" onclick="approveStudentFeeConfig()">
                                    Chấp nhận
                                </button>
                                <button class="btn btn-danger" id="student-fee-config-reject-btn" style="display:none;" onclick="openRejectStudentFeeConfigModal()">
                                    Từ chối
                                </button>
                            </div>
                        </div>

                        <div id="student-fee-config-feedback-box" style="display:none; margin-top: 10px;">
                            <div id="student-fee-config-feedback-inner" style="padding: 10px 12px; border: 1px solid #E3E6EC; border-radius: 8px; background: #FFF6F6; color: #2D2D2D;">
                                <div>
                                    <strong>Lý do từ chối:</strong>
                                    <span id="student-fee-config-reject-reason-text"></span>
                                </div>
                                <div id="student-fee-config-resubmit-row" style="display:none; margin-top: 6px;">
                                    <strong>Xác nhận đã chỉnh sửa:</strong>
                                    <span id="student-fee-config-resubmit-text"></span>
                                </div>
                                <div id="student-fee-config-needs-revise" style="margin-top: 6px; color:#505050; display:none;">
                                    (Cần biên soạn lại)
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table" id="student-fee-config-table">
                                <thead>
                                    <tr id="student-fee-config-table-header">
                                        <th>#</th>
                                        <th>Mã SV</th>
                                        <th>Họ và tên</th>
                                        <!-- Dynamic columns will be inserted here -->
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                <tbody id="student-fee-config-table-body">
                                    <tr>
                                        <td colspan="4" style="text-align: center; padding: 40px; color: #505050; font-size: 14px;">
                                            Vui lòng chọn kỳ học, đợt thanh toán và lớp ở trên để hiển thị bảng cấu hình
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Reject Student Fee Config Modal -->
                <div class="modal" id="student-fee-config-reject-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Nhập lý do từ chối</h3>
                            <button class="modal-close" onclick="closeModal('student-fee-config-reject-modal')">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Lý do từ chối <span class="required">*</span></label>
                                <textarea class="form-control" id="student-fee-config-reject-reason-input" rows="4" placeholder="Nhập lý do từ chối..."></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="closeModal('student-fee-config-reject-modal')">Hủy</button>
                                <button type="button" class="btn btn-danger" onclick="submitRejectStudentFeeConfig()">Xác nhận từ chối</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resubmit Student Fee Config Modal -->
                <div class="modal" id="student-fee-config-resubmit-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Xác nhận đã chỉnh sửa</h3>
                            <button class="modal-close" onclick="closeModal('student-fee-config-resubmit-modal')">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Lời xác nhận <span class="required">*</span></label>
                                <textarea class="form-control" id="student-fee-config-resubmit-note-input" rows="4" placeholder="VD: Tôi đã chỉnh sửa theo góp ý và gửi lại để duyệt."></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="closeModal('student-fee-config-resubmit-modal')">Hủy</button>
                                <button type="button" class="btn btn-primary" onclick="submitResubmitStudentFeeConfig()">Gửi lại duyệt</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Debt Management Module -->
                <div class="module-content" id="debt-management-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Quản lý khoản nợ</h3>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã học sinh</th>
                                        <th>Tên học sinh</th>
                                        <th>Đợt thanh toán</th>
                                        <th>Số tiền cần thanh toán</th>
                                        <th>Số tiền nợ</th>
                                        <th>Trạng thái</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="debt-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>STU001</td>
                                        <td>Nguyễn Văn A</td>
                                        <td>First Semester Payment</td>
                                        <td>1,500,000 MMK</td>
                                        <td><span class="badge badge-danger">500,000 MMK</span></td>
                                        <td><span class="badge badge-danger">Đã hết hạn</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showDebtDetailFromRow(this)">👁️</button>
                                            <button class="btn-icon" style="background-color: rgba(40, 199, 111, 0.1);" title="Ghi nhận thanh toán" onclick="showRecordPaymentModal(1)">💵</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>STU002</td>
                                        <td>Trần Thị B</td>
                                        <td>First Semester Payment</td>
                                        <td>1,500,000 MMK</td>
                                        <td><span class="badge badge-danger">300,000 MMK</span></td>
                                        <td><span class="badge badge-success">Chưa hết hạn</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showDebtDetailFromRow(this)">👁️</button>
                                            <button class="btn-icon" style="background-color: rgba(40, 199, 111, 0.1);" title="Ghi nhận thanh toán" onclick="showRecordPaymentModal(2)">💵</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>STU003</td>
                                        <td>Lê Văn C</td>
                                        <td>Second Semester Payment</td>
                                        <td>1,200,000 MMK</td>
                                        <td><span class="badge badge-danger">200,000 MMK</span></td>
                                        <td><span class="badge badge-success">Chưa hết hạn</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showDebtDetailFromRow(this)">👁️</button>
                                            <button class="btn-icon" style="background-color: rgba(40, 199, 111, 0.1);" title="Ghi nhận thanh toán" onclick="showRecordPaymentModal(3)">💵</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Invoice Management Module -->
                <div class="module-content" id="invoice-management-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Quản lý Hóa đơn</h3>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã giao dịch</th>
                                        <th>Mã học sinh</th>
                                        <th>Tên học sinh</th>
                                        <th>Kì thanh toán</th>
                                        <th>Số tiền phải thanh toán</th>
                                        <th>Số tiền đã thanh toán</th>
                                        <th>Trạng thái</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="invoice-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>INV001</td>
                                        <td>STU001</td>
                                        <td>Nguyễn Văn A</td>
                                        <td>First Semester Payment</td>
                                        <td>1,500,000 MMK</td>
                                        <td>1,000,000 MMK</td>
                                        <td><span class="badge badge-warning">Chờ xác nhận</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết">👁️</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>INV002</td>
                                        <td>STU002</td>
                                        <td>Trần Thị B</td>
                                        <td>First Semester Payment</td>
                                        <td>1,500,000 MMK</td>
                                        <td>1,500,000 MMK</td>
                                        <td><span class="badge badge-success">Đã xác nhận</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết">👁️</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>INV003</td>
                                        <td>STU003</td>
                                        <td>Lê Văn C</td>
                                        <td>Second Semester Payment</td>
                                        <td>1,200,000 MMK</td>
                                        <td>800,000 MMK</td>
                                        <td><span class="badge badge-warning">Chờ xác nhận</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết">👁️</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Final Grade Module - Nhập điểm cuối kỳ -->
                <div class="module-content" id="final-grade-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Nhập điểm cuối kỳ</h3>
                            <button class="btn btn-primary" onclick="showAddFinalGradeForm()">
                                <span>+</span> Thêm điểm mới
                            </button>
                        </div>
                    
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã học sinh</th>
                                        <th>Tên học sinh</th>
                                        <th>Môn học</th>
                                        <th>Lớp học</th>
                                        <th>Kỳ học</th>
                                        <th>Điểm</th>
                                        <th>Ghi chú</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="final-grade-table-body">
                                    <!-- Data will be loaded dynamically -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add Final Grade Form Modal -->
                    <div class="modal" id="add-final-grade-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm điểm cuối kỳ mới</h3>
                                <button class="modal-close" onclick="closeModal('add-final-grade-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="final-grade-form">
                                    <div class="form-group">
                                        <label>Kỳ học <span class="required">*</span></label>
                                        <select class="form-control" id="final-grade-semester" required>
                                            <option value="">-- Chọn kỳ học --</option>
                                            <option value="Học kỳ 1">Học kỳ 1</option>
                                            <option value="Học kỳ 2">Học kỳ 2</option>
                                            <option value="Học kỳ 3">Học kỳ 3</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Môn học <span class="required">*</span></label>
                                        <select class="form-control" id="final-grade-subject" required>
                                            <option value="">-- Chọn môn học --</option>
                                            <option value="Toán">Toán</option>
                                            <option value="Văn">Văn</option>
                                            <option value="Anh">Anh</option>
                                            <option value="Lý">Lý</option>
                                            <option value="Hóa">Hóa</option>
                                            <option value="Sinh">Sinh</option>
                                            <option value="Sử">Sử</option>
                                            <option value="Địa">Địa</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Lớp học <span class="required">*</span></label>
                                        <select class="form-control" id="final-grade-class" required>
                                            <option value="">-- Chọn lớp --</option>
                                            <option value="10A1">10A1</option>
                                            <option value="10A2">10A2</option>
                                            <option value="11A1">11A1</option>
                                            <option value="11A2">11A2</option>
                                            <option value="12A1">12A1</option>
                                            <option value="12A2">12A2</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Học sinh <span class="required">*</span></label>
                                        <select class="form-control" id="final-grade-student" required>
                                            <option value="">-- Chọn học sinh --</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Điểm <span class="required">*</span></label>
                                        <input type="number" class="form-control" id="final-grade-score" required min="0" max="10" step="0.1" placeholder="VD: 8.5">
                                        <small class="form-text">Nhập điểm từ 0 đến 10</small>
                                    </div>
                                    <div class="form-group">
                                        <label>Ghi chú</label>
                                        <textarea class="form-control" id="final-grade-note" rows="3" placeholder="Nhập ghi chú (nếu có)"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-final-grade-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grade Module - Tạo đầu điểm -->
                <div class="module-content" id="grade-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Tạo đầu điểm</h3>
                            <button class="btn btn-primary" onclick="showAddGradePointForm()">
                                <span>+</span> Thêm đầu điểm mới
                            </button>
                        </div>
                    
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Mã đầu điểm</th>
                                        <th>Môn học</th>
                                        <th>Tên đầu điểm</th>
                                        <th>Tỷ trọng</th>
                                        <th>Thang điểm tối đa</th>
                                        <th>Ghi chú</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="grade-point-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>GP001</td>
                                        <td>Toán</td>
                                        <td>Kiểm tra giữa kỳ</td>
                                        <td>30%</td>
                                        <td>10</td>
                                        <td>Điểm kiểm tra giữa kỳ môn Toán</td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-edit" title="Sửa">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa">🗑️</button>
                                            <button class="btn-icon btn-active" title="Active">✓</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add Grade Point Form Modal -->
                    <div class="modal" id="add-grade-point-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm đầu điểm mới</h3>
                                <button class="modal-close" onclick="closeModal('add-grade-point-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="grade-point-form">
                                    <div class="form-group">
                                        <label>Mã đầu điểm <span class="required">*</span></label>
                                        <input type="text" class="form-control" required placeholder="VD: GP001">
                                    </div>
                                    <div class="form-group">
                                        <label>Môn học <span class="required">*</span></label>
                                        <select class="form-control" required>
                                            <option value="">-- Chọn môn học --</option>
                                            <option value="math">Toán</option>
                                            <option value="literature">Văn</option>
                                            <option value="english">Anh</option>
                                            <option value="physics">Lý</option>
                                            <option value="chemistry">Hóa</option>
                                            <option value="biology">Sinh</option>
                                            <option value="history">Sử</option>
                                            <option value="geography">Địa</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Tên đầu điểm <span class="required">*</span></label>
                                        <input type="text" class="form-control" required placeholder="VD: Kiểm tra giữa kỳ">
                                    </div>
                                    <div class="form-group">
                                        <label>Tỷ trọng (%) <span class="required">*</span></label>
                                        <input type="number" class="form-control" required min="0" max="100" step="0.1" placeholder="VD: 30">
                                        <small class="form-text">Nhập tỷ trọng từ 0 đến 100%</small>
                                    </div>
                                    <div class="form-group">
                                        <label>Thang điểm tối đa <span class="required">*</span></label>
                                        <input type="number" class="form-control" required min="1" step="0.1" placeholder="VD: 10">
                                    </div>
                                    <div class="form-group">
                                        <label>Ghi chú</label>
                                        <textarea class="form-control" rows="3" placeholder="Nhập ghi chú (nếu có)"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-grade-point-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grade Input Module -->
                <div class="module-content" id="grade-input-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Nhập điểm</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select class="form-control" id="grade-semester-filter" style="width: 180px;" onchange="onSemesterChange()">
                                    <option value="">-- Chọn kỳ học --</option>
                                    <option value="semester1">Học kỳ 1</option>
                                    <option value="semester2">Học kỳ 2</option>
                                    <option value="semester3">Học kỳ 3</option>
                                </select>
                                <select class="form-control" id="grade-subject-filter" style="width: 200px;" onchange="onSubjectChange()">
                                    <option value="">-- Chọn môn học --</option>
                                    <option value="math">Toán</option>
                                    <option value="literature">Văn</option>
                                    <option value="english">Anh</option>
                                    <option value="physics">Lý</option>
                                    <option value="chemistry">Hóa</option>
                                    <option value="biology">Sinh</option>
                                    <option value="history">Sử</option>
                                    <option value="geography">Địa</option>
                                </select>
                                <select class="form-control" id="grade-class-filter" style="width: 180px;" onchange="onClassChange()">
                                    <option value="">-- Chọn lớp --</option>
                                    <option value="10A1">10A1</option>
                                    <option value="10A2">10A2</option>
                                    <option value="11A1">11A1</option>
                                    <option value="11A2">11A2</option>
                                    <option value="12A1">12A1</option>
                                    <option value="12A2">12A2</option>
                                </select>
                                <button class="btn btn-primary" onclick="saveGrades()">
                                    <span>💾</span> Lưu điểm
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table" id="grade-input-table">
                                <thead>
                                    <tr id="grade-input-table-header">
                                        <th>#</th>
                                        <th>Mã SV</th>
                                        <th>Họ và tên</th>
                                        <!-- Dynamic columns will be inserted here -->
                                        <th>Điểm tổng kết</th>
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                    <tbody id="grade-input-table-body">
                                        <tr>
                                            <td colspan="5" style="text-align: center; padding: 40px; color: #505050; font-size: 14px;">
                                                Vui lòng chọn kỳ học, môn học và lớp ở trên để hiển thị bảng nhập điểm
                                            </td>
                                        </tr>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Grade Approval Module -->
                <div class="module-content" id="grade-approval-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Duyệt điểm cho Admin</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select class="form-control" id="approval-status-filter" style="width: 180px;" onchange="filterApprovalList()">
                                    <option value="">-- Tất cả trạng thái --</option>
                                    <option value="pending">Chờ duyệt</option>
                                    <option value="approved">Đã duyệt</option>
                                    <option value="rejected">Đã từ chối</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Kỳ học</th>
                                        <th>Môn học</th>
                                        <th>Lớp</th>
                                        <th>Giáo viên</th>
                                        <th>Ngày nhập</th>
                                        <th>Số học sinh</th>
                                        <th>Trạng thái</th>
                                        <th>Hành động</th>
                                    </tr>
                                </thead>
                                <tbody id="grade-approval-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>Học kỳ 1</td>
                                        <td>Toán</td>
                                        <td>10A1</td>
                                        <td>Nguyễn Văn A</td>
                                        <td>15/01/2024</td>
                                        <td>25</td>
                                        <td><span class="badge badge-warning">Chờ duyệt</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showApprovalDetail(1)">👁️</button>
                                            <button class="btn-icon btn-edit" style="background-color: rgba(40, 199, 111, 0.1);" title="Duyệt" onclick="approveGrade(1)">✓</button>
                                            <button class="btn-icon btn-delete" title="Từ chối" onclick="rejectGrade(1)">✗</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Học kỳ 1</td>
                                        <td>Văn</td>
                                        <td>10A2</td>
                                        <td>Trần Thị B</td>
                                        <td>16/01/2024</td>
                                        <td>30</td>
                                        <td><span class="badge badge-success">Đã duyệt</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showApprovalDetail(2)">👁️</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Học kỳ 1</td>
                                        <td>Anh</td>
                                        <td>11A1</td>
                                        <td>Lê Văn C</td>
                                        <td>17/01/2024</td>
                                        <td>28</td>
                                        <td><span class="badge badge-warning">Chờ duyệt</span></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-view" title="Xem chi tiết" onclick="showApprovalDetail(3)">👁️</button>
                                            <button class="btn-icon btn-edit" style="background-color: rgba(40, 199, 111, 0.1);" title="Duyệt" onclick="approveGrade(3)">✓</button>
                                            <button class="btn-icon btn-delete" title="Từ chối" onclick="rejectGrade(3)">✗</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Approval Detail Modal -->
                    <div class="modal" id="approval-detail-modal">
                        <div class="modal-content modal-large">
                            <div class="modal-header">
                                <h3>Chi tiết điểm cần duyệt</h3>
                                <button class="modal-close" onclick="closeModal('approval-detail-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <div class="detail-view">
                                    <div class="detail-section">
                                        <h4 class="detail-section-title">Thông tin chung</h4>
                                        <div class="detail-row">
                                            <div class="detail-label">Kỳ học:</div>
                                            <div class="detail-value" id="approval-detail-semester">Học kỳ 1</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Môn học:</div>
                                            <div class="detail-value" id="approval-detail-subject">Toán</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Lớp:</div>
                                            <div class="detail-value" id="approval-detail-class">10A1</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Giáo viên:</div>
                                            <div class="detail-value" id="approval-detail-teacher">Nguyễn Văn A</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Ngày nhập:</div>
                                            <div class="detail-value" id="approval-detail-date">15/01/2024</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Số học sinh:</div>
                                            <div class="detail-value" id="approval-detail-student-count">25</div>
                                        </div>
                                        <div class="detail-row">
                                            <div class="detail-label">Trạng thái:</div>
                                            <div class="detail-value" id="approval-detail-status">
                                                <span class="badge badge-warning">Chờ duyệt</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="detail-section">
                                        <h4 class="detail-section-title">Danh sách điểm</h4>
                                        <div class="detail-table-container">
                                            <table class="detail-table">
                                                <thead>
                                                    <tr>
                                                        <th>STT</th>
                                                        <th>Mã SV</th>
                                                        <th>Họ và tên</th>
                                                        <th>Kiểm tra giữa kỳ (30%)</th>
                                                        <th>Kiểm tra cuối kỳ (40%)</th>
                                                        <th>Bài tập (20%)</th>
                                                        <th>Điểm TB</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="approval-detail-grades">
                                                    <tr>
                                                        <td>1</td>
                                                        <td>3120410024</td>
                                                        <td>Trương Hồ An</td>
                                                        <td>8.5</td>
                                                        <td>9.0</td>
                                                        <td>7.5</td>
                                                        <td><strong>8.4</strong></td>
                                                    </tr>
                                                    <tr>
                                                        <td>2</td>
                                                        <td>3121560010</td>
                                                        <td>Nguyễn Quốc Anh</td>
                                                        <td>7.0</td>
                                                        <td>8.0</td>
                                                        <td>8.5</td>
                                                        <td><strong>7.7</strong></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="detail-section">
                                        <h4 class="detail-section-title">Ghi chú</h4>
                                        <div class="detail-row">
                                            <div class="detail-label">Ghi chú của giáo viên:</div>
                                            <div class="detail-value" id="approval-detail-note">Đã nhập đầy đủ điểm cho tất cả học sinh trong lớp</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="button" class="btn btn-secondary" onclick="closeModal('approval-detail-modal')">Đóng</button>
                                    <button type="button" class="btn btn-danger" id="approval-reject-btn" onclick="rejectGradeFromDetail()">Từ chối</button>
                                    <button type="button" class="btn btn-primary" id="approval-approve-btn" onclick="approveGradeFromDetail()">Duyệt</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Schedule Module -->
                <div class="module-content" id="schedule-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Lịch học</h3>
                            <button class="btn btn-primary" onclick="showAddScheduleForm()">
                                <span>+</span> New Item
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>TEACHER</th>
                                        <th>ROOM</th>
                                        <th>FROM DATE</th>
                                        <th>TO DATE</th>
                                        <th>NOTE</th>
                                        <th>ACTIONS</th>
                                    </tr>
                                </thead>
                                <tbody id="schedule-table-body">
                                    <tr>
                                        <td>1</td>
                                        <td>emp1</td>
                                        <td>R001</td>
                                        <td>15:44 19/11/2025</td>
                                        <td>17:44 19/11/2025</td>
                                        <td>dạy và học</td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-edit" title="Sửa" onclick="editSchedule(1)">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa" onclick="deleteSchedule(1)">🗑️</button>
                                            <button class="btn-icon btn-active" title="Thêm" onclick="addScheduleItem(1)">+</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>nsa001</td>
                                        <td>101</td>
                                        <td>11:00 09/12/2025</td>
                                        <td>00:00 10/12/2025</td>
                                        <td></td>
                                        <td class="action-cell">
                                            <button class="btn-icon btn-edit" title="Sửa" onclick="editSchedule(2)">✏️</button>
                                            <button class="btn-icon btn-delete" title="Xóa" onclick="deleteSchedule(2)">🗑️</button>
                                            <button class="btn-icon btn-active" title="Thêm" onclick="addScheduleItem(2)">+</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Add Schedule Form Modal -->
                    <div class="modal" id="add-schedule-modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3>Thêm mới Lịch học</h3>
                                <button class="modal-close" onclick="closeModal('add-schedule-modal')">&times;</button>
                            </div>
                            <div class="modal-body">
                                <form id="schedule-form">
                                    <div class="form-group">
                                        <label>Giáo viên <span class="required">*</span></label>
                                        <input type="text" class="form-control" id="schedule-teacher" required placeholder="Nhập mã giáo viên">
                                    </div>
                                    <div class="form-group">
                                        <label>Phòng học <span class="required">*</span></label>
                                        <input type="text" class="form-control" id="schedule-room" required placeholder="Nhập mã phòng">
                                    </div>
                                    <div class="form-group">
                                        <label>Từ ngày giờ <span class="required">*</span></label>
                                        <input type="datetime-local" class="form-control" id="schedule-from-date" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Đến ngày giờ <span class="required">*</span></label>
                                        <input type="datetime-local" class="form-control" id="schedule-to-date" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Ghi chú</label>
                                        <textarea class="form-control" id="schedule-note" rows="3" placeholder="Nhập ghi chú (nếu có)"></textarea>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" class="btn btn-secondary" onclick="closeModal('add-schedule-modal')">Hủy</button>
                                        <button type="submit" class="btn btn-primary">Lưu</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Attendance Module -->
                <div class="module-content" id="attendance-module">
                    <div class="content-card">
                        <div class="card-header">
                            <h3 class="card-title">Điểm danh</h3>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <select class="form-control" id="attendance-semester-filter" style="width: 180px;" onchange="onAttendanceSemesterChange()">
                                    <option value="">-- Chọn kỳ học --</option>
                                    <option value="semester1">Học kỳ 1</option>
                                    <option value="semester2">Học kỳ 2</option>
                                    <option value="semester3">Học kỳ 3</option>
                                </select>
                                <select class="form-control" id="attendance-class-filter" style="width: 180px;" onchange="onAttendanceClassChange()">
                                    <option value="">-- Chọn lớp --</option>
                                    <option value="10A1">10A1</option>
                                    <option value="10A2">10A2</option>
                                    <option value="11A1">11A1</option>
                                    <option value="11A2">11A2</option>
                                    <option value="12A1">12A1</option>
                                    <option value="12A2">12A2</option>
                                </select>
                                <button class="btn btn-primary" onclick="saveAttendance()">
                                    <span>💾</span> Lưu điểm danh
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table" id="attendance-table">
                                <thead>
                                    <tr id="attendance-table-header">
                                        <th>#</th>
                                        <th>Mã SV</th>
                                        <th>Họ và tên</th>
                                        <!-- Dynamic columns will be inserted here -->
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                    <tbody id="attendance-table-body">
                                        <tr>
                                            <td colspan="4" style="text-align: center; padding: 40px; color: #505050; font-size: 14px;">
                                                Vui lòng chọn kỳ học và lớp ở trên để hiển thị bảng điểm danh
                                            </td>
                                        </tr>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Detail Modals -->
    
    <!-- FeeItem Detail Modal -->
    <div class="modal" id="feeitem-detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chi tiết Khoản phí</h3>
                <button class="modal-close" onclick="closeModal('feeitem-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-row">
                        <div class="detail-label">Mã code:</div>
                        <div class="detail-value" id="feeitem-detail-code">FEE001</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên khoản phí tiếng Anh:</div>
                        <div class="detail-value" id="feeitem-detail-name-en">Tuition Fee</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên khoản phí tiếng Myanmar:</div>
                        <div class="detail-value" id="feeitem-detail-name-my">ကျောင်းလချေး</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Mô tả:</div>
                        <div class="detail-value" id="feeitem-detail-description">Phí học phí hàng kỳ</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Trạng thái:</div>
                        <div class="detail-value">
                            <span class="badge badge-success">Đang hoạt động</span>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('feeitem-detail-modal')">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Period Detail Modal -->
    <div class="modal" id="payment-period-detail-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Chi tiết Đợt thanh toán</h3>
                <button class="modal-close" onclick="closeModal('payment-period-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-row">
                        <div class="detail-label">Mã code:</div>
                        <div class="detail-value" id="payment-period-detail-code">PP001</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Kỳ học:</div>
                        <div class="detail-value" id="payment-period-detail-semester">Học kỳ 1</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên đợt thanh toán tiếng Anh:</div>
                        <div class="detail-value" id="payment-period-detail-name-en">First Semester Payment</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên đợt thanh toán tiếng Myanmar:</div>
                        <div class="detail-value" id="payment-period-detail-name-my">ပထမနှစ်ဝက် ငွေပေးချေမှု</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Ngày bắt đầu:</div>
                        <div class="detail-value" id="payment-period-detail-start-date">01/01/2024</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Ngày kết thúc:</div>
                        <div class="detail-value" id="payment-period-detail-end-date">31/03/2024</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Trạng thái:</div>
                        <div class="detail-value">
                            <span class="badge badge-primary">Đang diễn ra</span>
                        </div>
                    </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Danh sách các khoản phí trong đợt thanh toán</h4>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Tên khoản phí</th>
                                        <th>Mã khoản phí</th>
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                <tbody id="payment-period-detail-fee-items">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                            <p id="payment-period-detail-fee-items-empty" style="text-align: center; padding: 20px; color: #666; display: none;">
                                Đợt thanh toán này chưa có khoản phí nào được cấu hình
                            </p>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('payment-period-detail-modal')">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Config Detail Modal -->
    <div class="modal" id="payment-config-detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chi tiết Cấu hình Đợt thanh toán</h3>
                <button class="modal-close" onclick="closeModal('payment-config-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-row">
                        <div class="detail-label">Mã cấu hình:</div>
                        <div class="detail-value" id="payment-config-detail-id">PC001</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên đợt thanh toán:</div>
                        <div class="detail-value" id="payment-config-detail-period">First Semester Payment</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Mã đợt thanh toán:</div>
                        <div class="detail-value" id="payment-config-detail-period-code">PP001</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Tên FeeItem:</div>
                        <div class="detail-value" id="payment-config-detail-feeitem">Tuition Fee</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Mã FeeItem:</div>
                        <div class="detail-value" id="payment-config-detail-feeitem-code">FEE001</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Ghi chú:</div>
                        <div class="detail-value" id="payment-config-detail-note">Ghi chú cho cấu hình đợt thanh toán</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Trạng thái:</div>
                        <div class="detail-value">
                            <span class="badge badge-success">Đang hoạt động</span>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('payment-config-detail-modal')">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Fee Config Detail Modal -->
    <div class="modal" id="student-fee-config-detail-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Chi tiết Cấu hình khoản phí cho học sinh</h3>
                <button class="modal-close" onclick="closeModal('student-fee-config-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin học sinh</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã học sinh:</div>
                            <div class="detail-value" id="student-fee-config-detail-student-code">STU001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tên học sinh:</div>
                            <div class="detail-value" id="student-fee-config-detail-student-name">Nguyễn Văn A</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Lớp:</div>
                            <div class="detail-value" id="student-fee-config-detail-class">10A1</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin thanh toán</h4>
                        <div class="detail-row">
                            <div class="detail-label">Đợt thanh toán:</div>
                            <div class="detail-value" id="student-fee-config-detail-period">First Semester Payment</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Mã đợt thanh toán:</div>
                            <div class="detail-value" id="student-fee-config-detail-period-code">PP001</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Các khoản thanh toán</h4>
                        <div class="detail-list" id="student-fee-config-detail-fee-items">
                            <div class="detail-list-item">
                                <span class="detail-list-label">Tuition Fee:</span>
                                <span class="detail-list-value">500,000 MMK</span>
                            </div>
                            <div class="detail-list-item">
                                <span class="detail-list-label">Library Fee:</span>
                                <span class="detail-list-value">50,000 MMK</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Các khoản miễn giảm</h4>
                        <div class="detail-list" id="student-fee-config-detail-discounts">
                            <div class="detail-list-item">
                                <span class="detail-list-label">Scholarship Discount:</span>
                                <span class="detail-list-value badge badge-success">-100,000 MMK</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Tổng hợp</h4>
                        <div class="detail-row">
                            <div class="detail-label">Tổng số tiền:</div>
                            <div class="detail-value highlight" id="student-fee-config-detail-total">1,500,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tổng miễn giảm:</div>
                            <div class="detail-value" id="student-fee-config-detail-total-discount">100,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền phải thanh toán:</div>
                            <div class="detail-value highlight primary" id="student-fee-config-detail-final-amount">1,400,000 MMK</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Ghi chú</h4>
                        <div class="detail-row">
                            <div class="detail-label">Ghi chú tiếng Anh:</div>
                            <div class="detail-value" id="student-fee-config-detail-note-en">Payment for first semester</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ghi chú tiếng Myanmar:</div>
                            <div class="detail-value" id="student-fee-config-detail-note-my">ပထမနှစ်ဝက်အတွက် ငွေပေးချေမှု</div>
                        </div>
                    </div>

                    <div class="detail-row">
                        <div class="detail-label">Trạng thái:</div>
                        <div class="detail-value">
                            <span class="badge badge-success">Đang hoạt động</span>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('student-fee-config-detail-modal')">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Debt Management Detail Modal -->
    <div class="modal" id="debt-detail-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Chi tiết Khoản nợ</h3>
                <button class="modal-close" onclick="closeModal('debt-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin học sinh</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã học sinh:</div>
                            <div class="detail-value" id="debt-detail-student-code">STU001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tên học sinh:</div>
                            <div class="detail-value" id="debt-detail-student-name">Nguyễn Văn A</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Lớp:</div>
                            <div class="detail-value" id="debt-detail-class">10A1</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin đợt thanh toán</h4>
                        <div class="detail-row">
                            <div class="detail-label">Đợt thanh toán:</div>
                            <div class="detail-value" id="debt-detail-period">First Semester Payment</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Mã đợt thanh toán:</div>
                            <div class="detail-value" id="debt-detail-period-code">PP001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ngày bắt đầu:</div>
                            <div class="detail-value" id="debt-detail-start-date">01/01/2024</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ngày kết thúc:</div>
                            <div class="detail-value" id="debt-detail-end-date">31/03/2024</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Chi tiết thanh toán</h4>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th>Khoản phí</th>
                                        <th>Số tiền</th>
                                        <th>Đã thanh toán</th>
                                        <th>Còn nợ</th>
                                    </tr>
                                </thead>
                                <tbody id="debt-detail-items">
                                    <tr>
                                        <td>Tuition Fee</td>
                                        <td>500,000 MMK</td>
                                        <td>300,000 MMK</td>
                                        <td><span class="badge badge-danger">200,000 MMK</span></td>
                                    </tr>
                                    <tr>
                                        <td>Library Fee</td>
                                        <td>50,000 MMK</td>
                                        <td>50,000 MMK</td>
                                        <td><span class="badge badge-success">0 MMK</span></td>
                                    </tr>
                                    <tr>
                                        <td>Lab Fee</td>
                                        <td>100,000 MMK</td>
                                        <td>50,000 MMK</td>
                                        <td><span class="badge badge-danger">50,000 MMK</span></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="detail-table-total">
                                        <td><strong>Tổng cộng</strong></td>
                                        <td><strong>650,000 MMK</strong></td>
                                        <td><strong>400,000 MMK</strong></td>
                                        <td><strong><span class="badge badge-danger">250,000 MMK</span></strong></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Tổng hợp</h4>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền cần thanh toán:</div>
                            <div class="detail-value" id="debt-detail-total-amount">1,500,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền đã thanh toán:</div>
                            <div class="detail-value highlight success" id="debt-detail-paid-amount">1,000,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền nợ:</div>
                            <div class="detail-value highlight danger" id="debt-detail-debt-amount">500,000 MMK</div>
                        </div>
                    </div>

                    <div class="detail-row">
                        <div class="detail-label">Trạng thái hạn thanh toán:</div>
                        <div class="detail-value" id="debt-detail-expiry-status">
                            <span class="badge badge-warning">Đang nợ</span>
                        </div>
                    </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Lịch sử thanh toán</h4>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Ngày thanh toán</th>
                                        <th>Số tiền</th>
                                        <th>Phương thức</th>
                                        <th>Tên người nộp</th>
                                        <th>SĐT người nộp</th>
                                        <th>Người ghi nhận</th>
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                <tbody id="debt-payment-history">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                            <p id="debt-payment-history-empty" style="text-align: center; padding: 20px; color: #666; display: none;">
                                Chưa có lịch sử thanh toán
                            </p>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('debt-detail-modal')">Đóng</button>
                    <button type="button" class="btn btn-primary" id="debt-detail-record-payment-btn" onclick="showRecordPaymentModalFromDetail()">Ghi nhận thanh toán</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Debt Modal -->
    <div class="modal" id="update-debt-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Cập nhật khoản phí đã đóng</h3>
                <button class="modal-close" onclick="closeModal('update-debt-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin học sinh</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã học sinh:</div>
                            <div class="detail-value" id="update-debt-student-code">STU001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tên học sinh:</div>
                            <div class="detail-value" id="update-debt-student-name">Nguyễn Văn A</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Đợt thanh toán:</div>
                            <div class="detail-value" id="update-debt-period">First Semester Payment</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Danh sách các khoản phí</h4>
                        <p class="form-text" style="margin-bottom: 16px; color: #666;">Vui lòng tích chọn các khoản phí mà học sinh đã đóng:</p>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th style="width: 50px;">
                                            <input type="checkbox" id="select-all-fees" onchange="toggleAllFees(this)">
                                        </th>
                                        <th>STT</th>
                                        <th>Khoản phí</th>
                                        <th>Số tiền</th>
                                        <th>Trạng thái thanh toán</th>
                                    </tr>
                                </thead>
                                <tbody id="update-debt-fee-items">
                                    <tr>
                                        <td style="text-align: center;">
                                            <input type="checkbox" class="fee-checkbox" data-fee-id="1" data-amount="500000">
                                        </td>
                                        <td>1</td>
                                        <td>Tuition Fee</td>
                                        <td>500,000 MMK</td>
                                        <td><span class="badge badge-danger">Chưa đóng</span></td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">
                                            <input type="checkbox" class="fee-checkbox" data-fee-id="2" data-amount="50000" checked>
                                        </td>
                                        <td>2</td>
                                        <td>Library Fee</td>
                                        <td>50,000 MMK</td>
                                        <td><span class="badge badge-success">Đã đóng</span></td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: center;">
                                            <input type="checkbox" class="fee-checkbox" data-fee-id="3" data-amount="100000">
                                        </td>
                                        <td>3</td>
                                        <td>Lab Fee</td>
                                        <td>100,000 MMK</td>
                                        <td><span class="badge badge-danger">Chưa đóng</span></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="detail-table-total">
                                        <td colspan="3" style="text-align: right; font-weight: bold;">Tổng số tiền đã chọn:</td>
                                        <td style="font-weight: bold;" id="update-debt-total-selected">50,000 MMK</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('update-debt-modal')">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveDebtUpdate()">Lưu cập nhật</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Record Payment Modal -->
    <div class="modal" id="record-payment-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Ghi nhận đợt thanh toán thủ công</h3>
                <button class="modal-close" onclick="closeModal('record-payment-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin học sinh</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã học sinh:</div>
                            <div class="detail-value" id="record-payment-student-code">STU001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tên học sinh:</div>
                            <div class="detail-value" id="record-payment-student-name">Nguyễn Văn A</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Đợt thanh toán:</div>
                            <div class="detail-value" id="record-payment-period">First Semester Payment</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền còn nợ:</div>
                            <div class="detail-value highlight danger" id="record-payment-remaining-debt">500,000 MMK</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin thanh toán</h4>
                        <form id="record-payment-form">
                            <div class="form-group">
                                <label>Ngày thanh toán <span class="required">*</span></label>
                                <input type="date" class="form-control" id="record-payment-date" required>
                            </div>
                            <div class="form-group">
                                <label>Số tiền thanh toán <span class="required">*</span></label>
                                <input type="number" class="form-control" id="record-payment-amount" min="1" required placeholder="Nhập số tiền thanh toán">
                            </div>
                            <div class="form-group">
                                <label>Phương thức thanh toán <span class="required">*</span></label>
                                <select class="form-control" id="record-payment-method" required>
                                    <option value="">-- Chọn phương thức --</option>
                                    <option value="cash">Tiền mặt</option>
                                    <option value="transfer">Chuyển khoản</option>
                                    <option value="card">Thẻ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Tên người nộp <span class="required">*</span></label>
                                <input type="text" class="form-control" id="record-payment-payer-name" required placeholder="Nhập tên người nộp tiền">
                            </div>
                            <div class="form-group">
                                <label>Số điện thoại người nộp <span class="required">*</span></label>
                                <input type="tel" class="form-control" id="record-payment-payer-phone" required placeholder="Nhập số điện thoại người nộp">
                            </div>
                            <div class="form-group">
                                <label>Người ghi nhận</label>
                                <input type="text" class="form-control" id="record-payment-recorder" readonly style="background-color: #f5f7fa; color: #505050;">
                            </div>
                            <div class="form-group">
                                <label>Các khoản phí được thanh toán</label>
                                <div class="detail-table-container" style="max-height: 200px; overflow-y: auto;">
                                    <table class="detail-table">
                                        <thead>
                                            <tr>
                                                <th style="width: 50px;">
                                                    <input type="checkbox" id="select-all-payment-fees" onchange="toggleAllPaymentFees(this)">
                                                </th>
                                                <th>STT</th>
                                                <th>Khoản phí</th>
                                                <th>Số tiền</th>
                                                <th>Đã thanh toán</th>
                                            </tr>
                                        </thead>
                                        <tbody id="record-payment-fee-items">
                                            <!-- Dynamic content -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Ghi chú</label>
                                <textarea class="form-control" id="record-payment-note" rows="3" placeholder="Nhập ghi chú (nếu có)"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('record-payment-modal')">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveRecordPayment()">Ghi nhận thanh toán</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice Detail Modal -->
    <div class="modal" id="invoice-detail-modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>Chi tiết Hóa đơn</h3>
                <button class="modal-close" onclick="closeModal('invoice-detail-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-view">
                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin hóa đơn</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã giao dịch:</div>
                            <div class="detail-value highlight" id="invoice-detail-code">INV001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ngày tạo:</div>
                            <div class="detail-value" id="invoice-detail-date">15/01/2024</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Trạng thái:</div>
                            <div class="detail-value" id="invoice-detail-status">
                                <span class="badge badge-warning">Chờ xác nhận</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin học sinh</h4>
                        <div class="detail-row">
                            <div class="detail-label">Mã học sinh:</div>
                            <div class="detail-value" id="invoice-detail-student-code">STU001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tên học sinh:</div>
                            <div class="detail-value" id="invoice-detail-student-name">Nguyễn Văn A</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Lớp:</div>
                            <div class="detail-value" id="invoice-detail-class">10A1</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Thông tin kì thanh toán</h4>
                        <div class="detail-row">
                            <div class="detail-label">Kì thanh toán:</div>
                            <div class="detail-value" id="invoice-detail-period">First Semester Payment</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Mã đợt thanh toán:</div>
                            <div class="detail-value" id="invoice-detail-period-code">PP001</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ngày bắt đầu:</div>
                            <div class="detail-value" id="invoice-detail-period-start">01/01/2024</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Ngày kết thúc:</div>
                            <div class="detail-value" id="invoice-detail-period-end">31/03/2024</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Chi tiết các khoản phí</h4>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Khoản phí</th>
                                        <th>Số tiền</th>
                                        <th>Đã thanh toán</th>
                                        <th>Còn lại</th>
                                    </tr>
                                </thead>
                                <tbody id="invoice-detail-items">
                                    <tr>
                                        <td>1</td>
                                        <td>Tuition Fee</td>
                                        <td>500,000 MMK</td>
                                        <td>300,000 MMK</td>
                                        <td><span class="badge badge-danger">200,000 MMK</span></td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Library Fee</td>
                                        <td>50,000 MMK</td>
                                        <td>50,000 MMK</td>
                                        <td><span class="badge badge-success">0 MMK</span></td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Lab Fee</td>
                                        <td>100,000 MMK</td>
                                        <td>100,000 MMK</td>
                                        <td><span class="badge badge-success">0 MMK</span></td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>Sports Fee</td>
                                        <td>75,000 MMK</td>
                                        <td>50,000 MMK</td>
                                        <td><span class="badge badge-danger">25,000 MMK</span></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="detail-table-total">
                                        <td colspan="2"><strong>Tổng cộng</strong></td>
                                        <td><strong id="invoice-detail-total-amount">725,000 MMK</strong></td>
                                        <td><strong id="invoice-detail-paid-amount">500,000 MMK</strong></td>
                                        <td><strong><span class="badge badge-danger" id="invoice-detail-remaining">225,000 MMK</span></strong></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Tổng hợp thanh toán</h4>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền phải thanh toán:</div>
                            <div class="detail-value highlight" id="invoice-detail-required-amount">1,500,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền đã thanh toán:</div>
                            <div class="detail-value highlight success" id="invoice-detail-total-paid">1,000,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Số tiền còn lại:</div>
                            <div class="detail-value highlight danger" id="invoice-detail-total-remaining">500,000 MMK</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Tỷ lệ thanh toán:</div>
                            <div class="detail-value" id="invoice-detail-payment-percentage">66.67%</div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4 class="detail-section-title">Lịch sử thanh toán</h4>
                        <div class="detail-table-container">
                            <table class="detail-table">
                                <thead>
                                    <tr>
                                        <th>Ngày thanh toán</th>
                                        <th>Số tiền</th>
                                        <th>Phương thức</th>
                                        <th>Ghi chú</th>
                                    </tr>
                                </thead>
                                <tbody id="invoice-detail-payment-history">
                                    <tr>
                                        <td>10/01/2024</td>
                                        <td>500,000 MMK</td>
                                        <td>Chuyển khoản</td>
                                        <td>Thanh toán lần 1</td>
                                    </tr>
                                    <tr>
                                        <td>15/01/2024</td>
                                        <td>500,000 MMK</td>
                                        <td>Tiền mặt</td>
                                        <td>Thanh toán lần 2</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('invoice-detail-modal')">Đóng</button>
                    <button type="button" class="btn btn-primary" id="invoice-confirm-btn" onclick="confirmInvoice()">Xác nhận hóa đơn</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
